<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Optimized HTML Max Editor is a lightweight tool for writing and previewing HTML code in real time.">
  <title>Optimized HTML Max Editor : Online HTML Editor</title>
  <link rel="icon" href="index.jpg">
  <style>
    /* ==================== */
    /* Base and Component Styles */
    /* ==================== */
    :root {
      --background-color: #2e2e2e;
      --text-color: #e0e0e0;
      --primary-color: #4CAF50;
      --secondary-color: #3e3e3e;
      --shadow-light: #444444;
      --shadow-dark: #1a1a1a;
    }

    html,
    body {
      height: 100%;
      padding: 0;
      margin: 0;
      background-color: var(--background-color);
      color: var(--text-color);
      font-family: Arial, sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
    }

    header {
      background: var(--secondary-color);
      padding: 10px;
      border-bottom: 1px solid var(--shadow-dark);
    }

    footer {
      background: var(--secondary-color);
      padding: 5px;
      border-top: 1px solid var(--shadow-dark);
      font-size: 0.85rem;
    }

    header div,
    footer {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
    }

    header div {
      margin: 5px;
    }

    main {
      display: flex;
      flex: 1;
    }

    main.vertical {
      flex-direction: column;
    }
    
    label {
        font-size: 0.85rem;
    }

    select,
    button,
    input[type="text"],
    input[type="range"],
    output {
      margin: 0;
      padding: 8px 12px;
      border: none;
      border-radius: 20px;
      background: var(--secondary-color);
      box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light);
      color: var(--text-color);
      outline: none;
      font-size: 0.85rem;
    }
    
    button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 8px;
        border-radius: 50%;
    }

    button, select, label[for="fileInput"] {
      cursor: pointer;
    }
    
    button:active, .toggle.active {
      box-shadow: inset 5px 5px 10px var(--shadow-dark), inset -5px -5px 10px var(--shadow-light);
    }

    input[type="file"] {
      display: none;
    }

    label[for="editorSizeInput"],
    #share {
      margin-left: auto;
    }

    .icon {
      width: 1.2rem;
      height: 1.2rem;
      fill: var(--text-color);
    }

    main div {
      position: relative;
    }

    #previewerWrapper {
      border-left: 5px solid var(--shadow-dark);
    }

    main.vertical #previewerWrapper {
      border-left: 0;
      border-top: 5px solid var(--shadow-dark);
    }

    main div * {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 0;
      margin: 0;
    }

    textarea {
      box-sizing: border-box;
      padding: 15px;
      outline: 0;
      resize: none;
      background: #1e1e1e;
      color: #d4d4d4;
      font-family: 'Courier New', Courier, monospace;
      border: none;
    }
    
    .number {
      font-family: monospace;
    }

    .hidden {
      display: none;
    }

    /* For social media and other links */
    footer a, footer address a {
        color: var(--primary-color);
        text-decoration: none;
    }
    footer a:hover {
        text-decoration: underline;
    }
    footer img {
        width: 1.2rem;
        height: 1.2rem;
    }
  </style>
</head>

<body>
  <!-- 
    OPTIMIZATION: SVG Sprite
    All icons are defined here once to reduce HTML size and improve caching.
    Each icon is wrapped in a <symbol> with a unique ID.
  -->
  <svg width="0" height="0" style="position:absolute">
    <symbol id="icon-download" viewBox="0 0 24 24"><path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z" /></symbol>
    <symbol id="icon-run" viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></symbol>
    <symbol id="icon-reset" viewBox="0 0 24 24"><path d="M12,4C7.58,4 4,7.58 4,12C4,16.42 7.58,20 12,20C16.42,20 20,16.42 20,12C20,7.58 16.42,4 12,4M12,18C8.69,18 6,15.31 6,12C6,8.69 8.69,6 12,6C15.31,6 18,8.69 18,12C18,15.31 15.31,18 12,18M13.5,13.88V15H10.5V13.88L12.13,12.25L10.5,10.63V9H13.5V10.13L11.88,11.75L13.5,13.38V13.88Z" /></symbol>
    <symbol id="icon-select" viewBox="0 0 24 24"><path d="M4,2A2,2 0 0,0 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4A2,2 0 0,0 20,2H4M4,4H20V20H4V4Z" /></symbol>
    <symbol id="icon-open" viewBox="0 0 24 24"><path d="M9,16V10H15V16H9M11,12H13V14H11V12M20,6H12L10,4H4A2,2 0 0,0 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8A2,2 0 0,0 20,6Z" /></symbol>
    <symbol id="icon-vertical-view" viewBox="0 0 24 24"><path d="M3,21V3H21V21H3M5,5V19H19V5H5Z" /></symbol>
    <symbol id="icon-dark-mode" viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20V4Z" /></symbol>
    <symbol id="icon-spellcheck" viewBox="0 0 24 24"><path d="M11.5,2C6.81,2 3,5.81 3,10.5C3,15.19 6.81,19 11.5,19C16.19,19 20,15.19 20,10.5C20,5.81 16.19,2 11.5,2M11.5,17C7.91,17 5,14.09 5,10.5C5,6.91 7.91,4 11.5,4C15.09,4 18,6.91 18,10.5C18,14.09 15.09,17 11.5,17M12.5,15H10.5V13H12.5V15M12.5,11H10.5V6H12.5V11Z" /></symbol>
    <symbol id="icon-replace" viewBox="0 0 24 24"><path d="M11,13.5V21.5H13V13.5H11M11,2.5H13V10.5H11V2.5M4,11.5H20V13.5H4V11.5Z" /></symbol>
    <symbol id="icon-footer" viewBox="0 0 24 24"><path d="M20 21H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2zM4 5v14h16V5H4z" /></symbol>
    <symbol id="icon-match-case" viewBox="0 0 24 24"><path d="M1,19H4V22H6V19H9V17H1V19M2,5V11H4V7H6V11H8V5H2M14,5V15H12V11H10V15H8V5H14M20,11V15H18V13H16V15H14V11H20Z" /></symbol>
    <symbol id="icon-whole-word" viewBox="0 0 24 24"><path d="M2,3H22V5H2V3M2,7H22V9H2V7M2,11H22V13H2V11M2,15H22V17H2V15M2,19H22V21H2V19Z" /></symbol>
    <symbol id="icon-regex" viewBox="0 0 24 24"><path d="M22,6V18H16V20H18V22H14V20H16V18H13V20H15V22H11V20H13V18H10V20H12V22H8V20H10V18H2V6H8V4H6V2H10V4H8V6H11V4H9V2H13V4H11V6H14V4H12V2H16V4H14V6H22Z" /></symbol>
    <symbol id="icon-replace-all" viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M15.5,6.5L14,8L15.5,9.5L17,8L15.5,6.5M8.5,6.5L7,8L8.5,9.5L10,8L8.5,6.5M12,14A4,4 0 0,0 16,18H8A4,4 0 0,0 12,14Z" /></symbol>
    <symbol id="icon-undo" viewBox="0 0 24 24"><path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" /></symbol>
  </svg>

  <header>
    <div>
      <a href="" download="template.html" id="downloadLink" title="Download">
        <button type="button"><svg class="icon"><use href="#icon-download" /></svg></button>
      </a>
      <label for="fontSizeSelector">Font size</label>
      <select id="fontSizeSelector">
        <option>12</option><option>13</option><option selected>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>20</option><option>22</option><option>24</option>
      </select>
      <label for="previewSelector">Preview</label>
      <select id="previewSelector">
        <option>Instant</option>
        <optgroup label="Delayed">
          <option value="500" selected>0.5 s</option><option value="1000">1.0 s</option><option value="1500">1.5 s</option><option value="2000">2.0 s</option>
        </optgroup>
        <option>Manual</option>
      </select>
      <button type="button" id="runButton" title="Run"><svg class="icon"><use href="#icon-run" /></svg></button>
      <button type="button" id="resetButton" title="Reset"><svg class="icon"><use href="#icon-reset" /></svg></button>
      <button type="button" id="selectButton" title="Select All"><svg class="icon"><use href="#icon-select" /></svg></button>
      <label for="fileInput" title="Open File">
          <div style="display: inline-flex; padding: 8px; border-radius: 50%; cursor: pointer;">
              <svg class="icon"><use href="#icon-open" /></svg>
          </div>
      </label>
      <input type="file" accept="text/html" id="fileInput">
      <label for="editorSizeInput">Editor size</label>
      <input type="range" id="editorSizeInput">
      <output for="editorSizeInput" class="number" id="editorSizeOutput"></output>
      <!-- Toggle Buttons -->
      <button type="button" class="toggle" id="verticalViewToggle" title="Vertical View" data-action="toggleVerticalView"><svg class="icon"><use href="#icon-vertical-view" /></svg></button>
      <button type="button" class="toggle" id="darkEditorToggle" title="Dark Editor" data-action="toggleDarkEditor"><svg class="icon"><use href="#icon-dark-mode" /></svg></button>
      <button type="button" class="toggle" id="spellcheckToggle" title="Spellcheck" data-action="toggleSpellcheck"><svg class="icon"><use href="#icon-spellcheck" /></svg></button>
      <button type="button" class="toggle" id="replaceBarToggle" title="Replace" data-action="toggleReplaceBar"><svg class="icon"><use href="#icon-replace" /></svg></button>
      <button type="button" class="toggle" id="footerContainerToggle" title="Toggle Footer" data-action="toggleFooter"><svg class="icon"><use href="#icon-footer" /></svg></button>
    </div>
    <div id="replaceBar" class="hidden">
      <label for="findInput">Find</label>
      <input type="text" id="findInput">
      <label for="replaceInput">Replace</label>
      <input type="text" id="replaceInput">
      <button type="button" class="toggle" id="matchCaseToggle" title="Match Case" data-action="toggleMatchCase"><svg class="icon"><use href="#icon-match-case" /></svg></button>
      <button type="button" class="toggle" id="wholeWordToggle" title="Whole Word" data-action="toggleWholeWord"><svg class="icon"><use href="#icon-whole-word" /></svg></button>
      <button type="button" class="toggle" id="regexModeToggle" title="Regex" data-action="toggleRegexMode"><svg class="icon"><use href="#icon-regex" /></svg></button>
      <button type="button" id="replaceAllButton" title="Replace All"><svg class="icon"><use href="#icon-replace-all" /></svg></button>
      <button type="button" id="undoButton" disabled title="Undo"><svg class="icon"><use href="#icon-undo" /></svg></button>
      <output for="findInput matchCaseToggle wholeWordToggle regexModeToggle editor" id="replaceFeedback"></output>
    </div>
  </header>
  <main>
    <div id="editorWrapper">
      <textarea><!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HTML Document Template</title>
  <style>
    body { background-color: #fff; color: #333; font-family: Arial, sans-serif; }
    p { color: #555; }
  </style>
</head>
<body>
  <p>Hello, world!</p>
  <script>
    console.log(document.querySelector('p').textContent);
  </script>
</body>
</html></textarea>
    </div>
    <div id="previewerWrapper">
      <iframe></iframe>
    </div>
  </main>
  <footer>
    <output for="editor">
      <span class="number" id="characterCount"></span> <span id="characterLabel"></span> | <span class="number" id="byteCount"></span> <span id="byteLabel"></span>
    </output>
    <span id="share">Share</span>
    <a href="https://x.com/intent/post?text=HTML%20Editor%3A%20Online%20HTML%20Editor%20with%20Real-Time%20Preview&url=https%3A%2F%2Fhtmleditor.gitlab.io" target="_blank"><img src="images/x.svg" alt="X"></a>
    <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fhtmleditor.gitlab.io" target="_blank"><img src="images/facebook.svg" alt="Facebook"></a>
    <a href="https://www.linkedin.com/feed/?shareActive=true&shareUrl=https%3A%2F%2Fhtmleditor.gitlab.io" target="_blank"><img src="images/linkedin.svg" alt="LinkedIn"></a>
    <a href="mailto:?subject=HTML%20Editor%3A%20Online%20HTML%20Editor%20with%20Real-Time%20Preview&body=https%3A%2F%2Fhtmleditor.gitlab.io" target="_blank"><img src="images/email.svg" alt="Email"></a>
    <button type="button" id="copyButton"><img src="images/link.svg" alt="Link"></button>
    <output id="copyNotification"></output>
    <address><a href="https://Instagram.com/tubesoftyt.ig" title="Instagram">Feedback</a> | Created by <a href="https://tzproapks.blogspot.com/" rel="author">tzproapks</a></address>
  </footer>
  <script>
    // ====================
    // Constants and Variables
    // ====================
    const getEl = id => document.getElementById(id);
    const query = sel => document.querySelector(sel);

    const downloadLink = getEl('downloadLink');
    const fontSizeSelector = getEl('fontSizeSelector');
    const previewSelector = getEl('previewSelector');
    const runButton = getEl('runButton');
    const resetButton = getEl('resetButton');
    const selectButton = getEl('selectButton');
    const fileInput = getEl('fileInput');
    const editorSizeInput = getEl('editorSizeInput');
    const editorSizeOutput = getEl('editorSizeOutput');
    const verticalViewToggle = getEl('verticalViewToggle');
    const darkEditorToggle = getEl('darkEditorToggle');
    const spellcheckToggle = getEl('spellcheckToggle');
    const replaceBarToggle = getEl('replaceBarToggle');
    const footerContainerToggle = getEl('footerContainerToggle');
    const replaceBar = getEl('replaceBar');
    const findInput = getEl('findInput');
    const replaceInput = getEl('replaceInput');
    const matchCaseToggle = getEl('matchCaseToggle');
    const wholeWordToggle = getEl('wholeWordToggle');
    const regexModeToggle = getEl('regexModeToggle');
    const replaceAllButton = getEl('replaceAllButton');
    const undoButton = getEl('undoButton');
    const replaceFeedback = getEl('replaceFeedback');
    const mainContainer = query('main');
    const editorWrapper = getEl('editorWrapper');
    const previewerWrapper = getEl('previewerWrapper');
    const editor = query('textarea');
    const previewer = query('iframe');
    const footerContainer = query('footer');
    const characterCount = getEl('characterCount');
    const characterLabel = getEl('characterLabel');
    const byteCount = getEl('byteCount');
    const byteLabel = getEl('byteLabel');
    const copyButton = getEl('copyButton');
    const copyNotification = getEl('copyNotification');
    const header = query('header');
    
    const numberFormatter = new Intl.NumberFormat();
    let previousEditorValue = null;

    // ====================
    // Reusable Functions
    // ====================
    const createContentBlob = () => new Blob([editor.value], { type: 'text/html; charset=utf-8' });
    
    function debounce(callback) {
      let timeout = null;
      return delay => {
        clearTimeout(timeout);
        timeout = setTimeout(callback, delay);
      };
    }

    const toggleClass = (element, className, force) => element.classList.toggle(className, force);
    const isActive = button => button.classList.contains('active');
    const deactivate = button => button.classList.remove('active');
    
    function interpretEscapeSequences(str) {
      const escapeMap = { '\\n': '\n', '\\r': '\r', '\\t': '\t', '\\\\': '\\' };
      return str.replace(/\\[nrt\\]/g, match => escapeMap[match]);
    }
    
    const separateThousands = number => numberFormatter.format(number);

    // ====================
    // Core Functions
    // ====================
    const createDownloadURL = () => downloadLink.href = URL.createObjectURL(createContentBlob());
    const resizeFont = () => editor.style.fontSize = `${fontSizeSelector.value}px`;
    
    function resizeEditor() {
      const value = editorSizeInput.value;
      editorWrapper.style.flexGrow = value;
      previewerWrapper.style.flexGrow = 100 - value;
      editorSizeOutput.value = (value / 100).toFixed(2);
    }
    
    const updatePlaceholder = () => findInput.placeholder = isActive(regexModeToggle) ? 'pattern or /pattern/flags' : '';
    const clearReplaceFeedback = () => { if (replaceFeedback.value) replaceFeedback.value = ''; };
    
    function clearUndoState() {
      if (previousEditorValue !== null) {
        previousEditorValue = null;
        undoButton.disabled = true;
      }
    }

    /**
     * OPTIMIZATION: Using `srcdoc`
     * This is a modern, faster, and more secure way to update iframe content
     * compared to replacing the element or using document.write().
     */
    const preview = () => previewer.srcdoc = editor.value;

    function updateCharacterCount() {
        const count = editor.value.length;
        characterCount.textContent = separateThousands(count);
        characterLabel.textContent = count === 1 ? 'character' : 'characters';
    }

    function updateByteCount() {
        const count = createContentBlob().size;
        byteCount.textContent = separateThousands(count);
        byteLabel.textContent = count === 1 ? 'byte' : 'bytes';
    }

    function updateDocumentMetrics() {
      if (!footerContainer.classList.contains('hidden')) {
        updateCharacterCount();
        updateByteCount();
      }
    }

    // ====================
    // Debounced Functions
    // ====================
    const debouncedPreview = debounce(preview);
    const debouncedUpdateDocumentMetrics = debounce(updateDocumentMetrics);
    const debouncedClearCopyNotification = debounce(() => copyNotification.value = '', 2000);

    // ====================
    // Preview Update Dispatcher
    // ====================
    function dispatchPreviewUpdate() {
      const mode = previewSelector.value;
      if (mode === 'Instant') preview();
      else if (mode !== 'Manual') debouncedPreview(mode);
    }

    // ====================
    // Event Listeners
    // ====================
    downloadLink.addEventListener('click', createDownloadURL);
    downloadLink.addEventListener('contextmenu', createDownloadURL);
    fontSizeSelector.addEventListener('change', resizeFont);
    runButton.addEventListener('click', preview);
    editorSizeInput.addEventListener('input', resizeEditor);

    /**
     * OPTIMIZATION: Event Delegation for Toggle Buttons
     * A single event listener on the header is more memory-efficient than one per button.
     * It uses the `data-action` attribute to determine which function to run.
     */
    header.addEventListener('click', event => {
        const button = event.target.closest('button.toggle');
        if (!button) return;

        const action = button.dataset.action;
        toggleClass(button, 'active');

        switch(action) {
            case 'toggleVerticalView':
                toggleClass(mainContainer, 'vertical');
                break;
            case 'toggleDarkEditor':
                toggleClass(editor, 'dark');
                break;
            case 'toggleSpellcheck':
                editor.spellcheck = isActive(button);
                break;
            case 'toggleReplaceBar':
                toggleClass(replaceBar, 'hidden', !isActive(button));
                break;
            case 'toggleFooter':
                toggleClass(footerContainer, 'hidden', !isActive(button));
                updateDocumentMetrics();
                break;
            case 'toggleMatchCase':
            case 'toggleWholeWord':
                deactivate(regexModeToggle);
                updatePlaceholder();
                clearReplaceFeedback();
                break;
            case 'toggleRegexMode':
                deactivate(matchCaseToggle);
                deactivate(wholeWordToggle);
                updatePlaceholder();
                clearReplaceFeedback();
                break;
        }
    });

    [findInput, replaceInput, editor].forEach(el => {
        el.addEventListener('input', () => {
            clearReplaceFeedback();
            if (el === editor) {
                clearUndoState();
                dispatchPreviewUpdate();
                debouncedUpdateDocumentMetrics(500);
            }
        });
    });

    resetButton.addEventListener('click', () => {
      if (editor.value && editor.value !== editor.defaultValue && !confirm('Are you sure you want to reset? All unsaved changes will be lost.')) return;
      fileInput.value = '';
      downloadLink.download = 'template.html';
      editor.value = editor.defaultValue;
      clearReplaceFeedback();
      clearUndoState();
      dispatchPreviewUpdate();
      updateDocumentMetrics();
    });

    selectButton.addEventListener('click', () => editor.select());

    fileInput.addEventListener('change', async function() {
      const file = this.files[0];
      if (file) {
        downloadLink.download = file.name;
        editor.value = await file.text();
        clearReplaceFeedback();
        clearUndoState();
        dispatchPreviewUpdate();
        updateDocumentMetrics();
      }
    });

    replaceAllButton.addEventListener('click', () => {
      const findValue = findInput.value;
      if (!findValue) {
        replaceFeedback.value = 'No find term entered';
        return;
      }

      let pattern;
      let flags = 'g';
      if (isActive(regexModeToggle)) {
        const regexMatch = findValue.match(/^\/(.*)\/(.*)$/);
        if (regexMatch) {
          [, pattern, flags] = regexMatch;
          if (!flags.includes('g')) flags += 'g';
        } else {
          pattern = findValue;
        }
      } else {
        pattern = findValue.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
        if (isActive(wholeWordToggle)) {
          pattern = `(?<![\\p{L}\\p{N}_])${pattern}(?![\\p{L}\\p{N}_])`;
          flags += 'u';
        }
        if (!isActive(matchCaseToggle)) flags += 'i';
      }

      try {
        const regex = new RegExp(pattern, flags);
        const matches = editor.value.match(regex);
        if (matches) {
          const matchCount = matches.length;
          previousEditorValue = editor.value;
          const replaceValue = replaceInput.value;
          editor.value = editor.value.replace(regex, isActive(regexModeToggle) ? interpretEscapeSequences(replaceValue) : () => replaceValue);
          replaceFeedback.innerHTML = `<span class="number">${separateThousands(matchCount)}</span> ${matchCount === 1 ? 'replacement' : 'replacements'} made`;
          undoButton.disabled = false;
          dispatchPreviewUpdate();
          updateDocumentMetrics();
        } else {
          replaceFeedback.value = 'No matches found';
        }
      } catch (error) {
        replaceFeedback.value = error.message;
      }
    });

    undoButton.addEventListener('click', () => {
      if (previousEditorValue !== null) {
          editor.value = previousEditorValue;
          replaceFeedback.value = 'Replacement undone';
          clearUndoState();
          dispatchPreviewUpdate();
          updateDocumentMetrics();
      }
    });

    copyButton.addEventListener('click', () => {
      navigator.clipboard.writeText(location.href);
      copyNotification.value = 'Link copied';
      debouncedClearCopyNotification();
    });

    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        const state = {
          toggles: {
            spellcheck: spellcheckToggle.className, vertical: verticalViewToggle.className, dark: darkEditorToggle.className,
            replace: replaceBarToggle.className, footer: footerContainerToggle.className, matchCase: matchCaseToggle.className,
            wholeWord: wholeWordToggle.className, regex: regexModeToggle.className,
          },
          selectors: { font: fontSizeSelector.value, preview: previewSelector.value },
          inputs: { editorSize: editorSizeInput.value, find: findInput.value, replace: replaceInput.value },
          editor: editor.value,
        };
        localStorage.setItem('state', JSON.stringify(state));
      }
    });

    // ====================
    // Initialization
    // ====================
    function initialize() {
        const restoredState = JSON.parse(localStorage.getItem('state'));
        if (restoredState) {
            spellcheckToggle.className = restoredState.toggles.spellcheck;
            verticalViewToggle.className = restoredState.toggles.vertical;
            darkEditorToggle.className = restoredState.toggles.dark;
            replaceBarToggle.className = restoredState.toggles.replace;
            footerContainerToggle.className = restoredState.toggles.footer;
            matchCaseToggle.className = restoredState.toggles.matchCase;
            wholeWordToggle.className = restoredState.toggles.wholeWord;
            regexModeToggle.className = restoredState.toggles.regex;
            fontSizeSelector.value = restoredState.selectors.font;
            previewSelector.value = restoredState.selectors.preview;
            editorSizeInput.value = restoredState.inputs.editorSize;
            findInput.value = restoredState.inputs.find;
            replaceInput.value = restoredState.inputs.replace;
            editor.value = restoredState.editor;
        }

        editor.spellcheck = isActive(spellcheckToggle);
        toggleClass(mainContainer, 'vertical', isActive(verticalViewToggle));
        toggleClass(editor, 'dark', isActive(darkEditorToggle));
        toggleClass(replaceBar, 'hidden', !isActive(replaceBarToggle));
        toggleClass(footerContainer, 'hidden', !isActive(footerContainerToggle));
        
        resizeFont();
        resizeEditor();
        updatePlaceholder();
        dispatchPreviewUpdate();
        updateDocumentMetrics();
    }
    
    initialize();
  </script>
</body>
</html>
